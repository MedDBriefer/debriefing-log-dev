/*! For license information please see main.d3fd4384.chunk.js.LICENSE.txt */
(this["webpackJsonp@meddbriefer/debriefer"]=this["webpackJsonp@meddbriefer/debriefer"]||[]).push([[0],{49:function(e,t,n){},57:function(e,t,n){},61:function(e,t,n){"use strict";n.r(t);var r,i=n(2),o=n.n(i),s=n(43),a=n.n(s),c=(n(49),n(25)),d=n(10),l=n(26),u=(n(56),n(57),n(7)),p=n(31),h=(n(40),n(42),function(e,t){var n=function(e){var t=p.default.apps.filter((function(t){return t.options.appId===e}));return 1===t.length?t[0]:null}(e.appId);return n||p.default.initializeApp(e,t)});"pam"===Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_APP_ENV?(console.log("using pjordan config"),r=h({apiKey:"AIzaSyB9eVT-fu4TOjxHoPAXqsnz9tCcbTJkTOw",authDomain:"pamdev-ea800.firebaseapp.com",projectId:"pamdev-ea800",storageBucket:"pamdev-ea800.appspot.com",messagingSenderId:"366450927885",appId:"1:366450927885:web:caa5f022ef1de182a0e844",measurementId:"G-JC5XZEPYT1"},"pam")):"scott"===Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_APP_ENV?(console.log("using scott config"),r=h({apiKey:"AIzaSyBEhbIdVW2F2vvvfvpNb2SsCDP9Yoc__z8",authDomain:"scottdev-f6528.firebaseapp.com",projectId:"scottdev-f6528",storageBucket:"scottdev-f6528.appspot.com",messagingSenderId:"447730403122",appId:"1:447730403122:web:1727020dbac4ad4cf6f92b"})):(console.log("using production config"),r=h({apiKey:"AIzaSyBOgWAbXUGckpad2sk0IUo00hZsV4WxG0E",authDomain:"meddbriefer-68cd4.firebaseapp.com",projectId:"meddbriefer-68cd4",storageBucket:"meddbriefer-68cd4.appspot.com",messagingSenderId:"1087114796018",appId:"1:1087114796018:web:679fbab38dbf78af0ce96b",measurementId:"G-Q7QZKC9KHW"},"production"));var b,f,m,v=r,O=(v.auth(),v.firestore()),g=n(6),j=n.n(g),y=n(11),w=n(19),P=(n(34),"assessment"),D="assessment-option",S="assessment-with-options",x="decision",E="decision-option",I="intervention",k="phase",N="required-action",T="sub-phase",A=Object.freeze({PHASE:k,SUB_PHASE:T,ASSESS:P,AWO:S,ASSESS_OPTION:D,ASSESSO:D,CL_HEADING:"checklist-heading",CL_PROMPT:"checklist-prompt",DECISION:x,DECISION_OPTION:E,DIST_PROMPT:"distinguishing-prompt",NESTED_CHECKLIST:"nested-checklist",REQUIRED:N,REQURED:N,INTERV:I,PROMPT_SET:"prompt-set",PROMPT:"prompt",ANSWER:"answer"}),F=Object.freeze({ONE:"one",OOM:"one-or-more",NONE:"none"}),C=(Object.freeze({ONE:"One",OOM:"One or more",NONE:"None"}),Object.freeze({PHASE:"",SUB_PHASE:"",ANSWER:"answer-",ASSESS:"assess-",AWO:"assessment-with-options-",ASSESS_OPTION:"assess-option-",CL_PROMPT:"cl-prompt-",DECISION:"decision-",DECISION_OPTION:"decision-option-",INTERV:"intv-",PROMPT_SET:"prompt-set-",PROMPT:"prompt-",REQUIRED:"required-action-"}),Object.freeze({AW:"airway",BR:"breathing",BL:"bleeding",SH:"shock"}),Object.freeze({AW:"Airway",BR:"Breathing",BL:"Bleeding",SH:"Shock"}),[P,S,x,N]),R=[D,E],B=[P,S,x,N,I,k,T],L=(Object.freeze({NONE:"",MIN:"minimal",OPT:"optional",REQ:"required",CONTRA:"contraindicated",UNN:"unnecessary",IR:"irrelevant"}),n(9)),q=(n(17),n(37),n(38),n(16)),M=(A.DIST_PROMPT,F.ONE,A.DIST_PROMPT,F.OOM,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,A.PROMPT,F.ONE,b={depth:3,type:"intervention",id:"menu-item-nasotracheal-intubation",interventionID:"intv-nasotracheal-intubation"},Object(q.a)(b,"interventionID","intv-nasotracheal-intubation"),Object(q.a)(b,"interventionID","intv-nasotracheal-intubation"),Object(q.a)(b,"intvCategoryID","intv-cat-airway"),f={depth:4,type:"intervention",id:"menu-item-rapid-sequence-intubation",interventionID:"intv-rapid-sequence-intubation"},Object(q.a)(f,"interventionID","intv-rapid-sequence-intubation"),Object(q.a)(f,"interventionID","intv-rapid-sequence-intubation"),Object(q.a)(f,"intvCategoryID","intv-cat-airway"),function(e,t){return e.collection("published-scenarios").doc(t).get().then((function(e){return e.data()}))}),_=function(){var e=Object(y.a)(j.a.mark((function e(t,n,r){var i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.collection(n).where("id","==","".concat(r)).get();case 2:return i=e.sent,e.abrupt("return",i.empty);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),W=function(e,t){return e.collection("logs").doc(t).get().then((function(e){var t=e.data();return t.id=e.id,t}))},H=function(e,t){return e.collection("debriefing-feedback-logs").doc(t).get().then((function(e){var t=e.data();return t.id=e.id,t}))},U=n(62),V=n(1),z=function(){var e=Object(i.useState)([]),t=Object(u.a)(e,2),n=t[0],r=t[1],o=Object(i.useState)(!1),s=Object(u.a)(o,2),a=s[0],d=s[1];return Object(i.useEffect)((function(){var e;(e=O,e.collection("logs").get().then((function(e){return e.docs.map((function(e){var t=e.data();return{id:e.id,label:t.label,scenario:t.scenarioName,userName:t.userName,timestamp:t.timestamp}}))}))).then((function(e){r(e),d(!0)})).catch((function(e){return console.log("error fetching logs",e)}))}),[]),a?Object(V.jsxs)(U.a,{striped:!0,borderless:!0,size:"sm",hover:!0,children:[Object(V.jsx)("thead",{children:Object(V.jsxs)("tr",{children:[Object(V.jsx)("th",{children:"Label"}),Object(V.jsx)("th",{children:"Scenario"}),Object(V.jsx)("th",{children:"Username"}),Object(V.jsx)("th",{children:"Timestamp"})]})}),Object(V.jsx)("tbody",{children:n.map((function(e){return Object(V.jsxs)("tr",{children:[Object(V.jsx)("td",{children:e.label}),Object(V.jsx)("td",{children:e.scenario}),Object(V.jsx)("td",{children:e.userName}),Object(V.jsx)("td",{children:e.timestamp}),Object(V.jsxs)("td",{children:[Object(V.jsx)(c.Link,{to:"/logs/".concat(e.id),children:"Analyze"}),"\xa0\xa0\xa0\xa0",Object(V.jsx)(c.Link,{to:"/debriefing-feedback-logs/".concat(e.id),children:"Review"})]})]},e.id)}))})]}):Object(V.jsx)("h4",{children:"fetching log data"})},Y=n(12),G={Good:"text-success",Caution:"text-warning",Problem:"text-danger","Not implemented":"text-muted"},K={Good:"sentiment_satisfied",Caution:"report_problem",Problem:"highlight_off","Not implemented":"sentiment_neutral"},Q={contraindicated:["Problem","You should not have done this action because it is contraindicated in this case +bos ?contraindicatedWhy +bos ?why +eos"],irrelevant:["Problem","You should not have done this action because it is irrelevant in this case +bos ?why +eos"],unnecessary:["Problem","You should not have done this action because it is unnecessary in this case +bos ?why +eos"],missingMinimal:["Problem","You did not do this action +bos ?why +eos"],missingOptional:["Caution","You did not do this action +bos but it was optional in this case +bos ?why +eos"],missingRequired:["Problem","You did not do this action +bos ?why +eos"],missingRequiredAssessment:["Problem","You did not do this action +bos ?assessmentFB +eos"],notNecessary:["Caution","You should not have done this action because it was unnecessary +bos ?why +eos"],assessment:["Good",""],"assessment-option":["Good",""],"decision-option":["Good",""],"required-action":["Good",""],goodIntv:["Good","?intvStatusFB +eos "],"misOrdered-assessment":["Problem","Doing this action was correct but it was done out of the recommended order +bos @orderingFB +eos"],"misOrdered-assessment-option":["Problem","Doing this action was correct but it was done out of the recommended order +bos @orderingFB +eos"],"misOrdered-decision-option":["Problem","Doing this action was correct but it was done out of the recommeded order +bos @orderingFB"],"misOrdered-required-action":["Problem","Doing this action was correct but it was done out of the recommeded order +bos @orderingFB"],"misOrdered-goodIntv":["Problem","Doing this action was correct but it was done out of the recommeded order +bos @orderingFB"],"misOrdered-phase-assessment":["Problem","Doing this action was correct but this section was not completed in the recommended order +bos @orderingFB +eos"],"misOrdered-phase-assessment-option":["Good","Doing this action was correct but this section was not completed in the recommended order +bos @orderingFB +eos"],"misOrdered-phase-decision-option":["Problem","Doing this action was correct but this section was not completed in the recommended order +bos @orderingFB"],"misOrdered-phase-required-action":["Problem","Doing this action was correct but this section was not completed in the recommended order +bos @orderingFB"],"misOrdered-phase-goodintv":["Problem","Doing this action was correct but this section was not completed in the recommended order +bos @orderingFB"],intvCheckWNoIntvFound:["Caution","You didn't do this intervention so it doesn't make sense to check the status of it at this point."],unexpectedPatientIntvCheck:["Caution","This status check is not likely to reveal any useful information."],patientIntvCheck:["Good",""],patientVitalCheck:["Good",""],"assessment-option-incorrect":["Problem","Doing this action was correct but there is a problem with how you planned to do it +bos @incorrectAnswerFB +eos "],"decision-option-incorrect":["Problem","Doing this action was correct but there is a problem with how you planned to do it +bos @incorrectAnswerFB +eos "],"incorrect-answers":["Problem","Doing this action is correct but there is a problem with how you planned to do it +bos @incorrectAnswersFB +bos ?intvStatusFB +eos"],"minimal-incorrect-answers":["Problem","Doing this action was correct and would solve the problem but you did not follow protocol +bos ?minimalWhy +bos also there is a problem with how you planned to do this intervention +bos @incorrectAnswersFB +bos ?intvStatusFB +eos"],minimal:["Caution","Doing this action is correct and solves the problem but you did not follow protocol +bos @minimalWhy +bos ?intvStatusFB +eos "],"misOrdered-assessment-option-incorrect":["Problem","Doing this action was correct but it was done out of the recommended order +bos @orderingFB +bos Also there is a problem with how you planned to do it +bos @incorrectAnswerFB +eos "],"misOrdered-decision-option-incorrect":["Problem","Doing this action was correct but it was done out of the recommended order +bos @orderingFB +bos Also there is a problem with how you planned to do it +bos @incorrectAnswerFB +eos "],"misOrdered-incorrect-answers":["Problem","Doing this action is correct but it was done out of the recommended order +bos @orderingFB +bos also there is a problem with how you planned to do it +bos @incorrectAnswersFB +bos ?intvStatusFB +eos"],"misOrdered-minimal-incorrect-answers":["Problem","Doing this action is correct but it was done out of the recommended order +bos @orderingFB +bos And while this would solve the problem, you did not follow protocol +bos @minimalWhy +bos also there is a problem with how you planned to do it +bos @incorrectAnswersFB +bos ?intvStatusFB +eos"],"misOrdered-minimal":["Problem","Doing this action is correct but it was done out of the recommended order +bos @orderingFB +bos And while this would solve the problem, you did not follow protocol +bos @minimalWhy +bos ?intvStatusFB +eos"],"misOrdered-phase-assessment-option-incorrect":["Problem","Doing this action was correct but this section was not completed in the recommended order +bos @orderingFB +bos Also there is a problem with how you planned to do it +bos @incorrectAnswerFB +eos "],"misOrdered-phase-decision-option-incorrect":["Problem","Doing this action was correct but this section was not completed in the recommended order +bos @orderingFB +bos Also there is a problem with how you planned to do it +bos @incorrectAnswerFB +eos "],"misOrdered-phase-incorrect-answers":["Problem","Doing this action is correct but this section was not completed in the recommended order +bos @orderingFB +bos also there is a problem with how you planned to do it +bos @incorrectAnswersFB +bos ?intvStatusFB +eos"],"misOrdered-phase-minimal-incorrect-answers":["Problem","Doing this action is correct but this section was not completed in the recommended order +bos @orderingFB +bos And while this would solve the problem, you did not follow protocol +bos ?minimalWhy +bos also there is a problem with how you planned to do it +bos @incorrectAnswersFB +bos ?intvStatusFB +eos"],"misOrdered-phase-minimal":["Problem","Doing this action is correct but this section was not completed in the recommended order +bos @orderingFB +bos And while this would solve the problem, you did not follow protocol +bos ?minimalWhy +bos ?intvStatusFB +eos"],green:["Good",""],red:["Problem",""],yellow:["Caution",""],default:["Not implemented","This action was not expected.  There could be an issue with how this scenario is represented within the system."]},J={absent:["absent","missingMinimal","missingRequired","missingRequiredAssessment"],errors:["misOrdered-assessment","misOrdered-assessment-option","misOrdered-decision-option","misOrdered-required-action","misOrdered-goodIntv","assessment-option-incorrect","decision-option-incorrect","incorrect-answers","minimal-incorrect-answers","misOrdered-assessment-option-incorrect","misOrdered-decision-option-incorrect","misOrdered-incorrect-answers","misOrdered-minimal-incorrect-answers","misOrdered-minimal","misOrdered-phase-assessment-option-incorrect","misOrdered-phase-decision-option-incorrect","misOrdered-phase-incorrect-answers","misOrdered-phase-minimal-incorrect-answers"],good:["good","assessment","assessment-option","decision-option","required-action","goodIntv","patientIntvCheck","patientVitalCheck","irrelevant","unnecessary","contraindicated","notNecessary","intvCheckWNoIntvFound","unexpectedPatientIntvCheck","default","minimal","misOrdered-phase-minimal","misOrdered-phase-assessment","misOrdered-phase-assessment-option","misOrdered-phase-decision-option","misOrdered-phase-required-action","misOrdered-phase-goodIntv"]},X={absent:["missingMinimal","missingRequired","missingRequiredAssessment"],misordered:["misOrdered-assessment","misOrdered-assessment-option","misOrdered-decision-option","misOrdered-required-action","misOrdered-goodIntv","misOrdered-minimal"],misorderedErrors:["misOrdered-assessment-option-incorrect","misOrdered-decision-option-incorrect","misOrdered-incorrect-answers","misOrdered-minimal-incorrect-answers","misOrdered-phase-assessment-option-incorrect","misOrdered-phase-decision-option-incorrect","misOrdered-phase-incorrect-answers","misOrdered-phase-minimal-incorrect-answers"],errors:["assessment-option-incorrect","decision-option-incorrect","incorrect-answers","minimal-incorrect-answers"],good:["assessment","assessment-option","decision-option","required-action","goodIntv","patientIntvCheck","patientVitalCheck","irrelevant","unnecessary","contraindicated","notNecessary","intvCheckWNoIntvFound","unexpectedPatientIntvCheck","default","minimal","misOrdered-phase-minimal","misOrdered-phase-assessment","misOrdered-phase-assessment-option","misOrdered-phase-decision-option","misOrdered-phase-required-action","misOrdered-phase-goodIntv"]},Z=[{scenarioName:"M2CA",exceptions:[["required-action-obtain-OPQRST","This cannot be assessed when GCS < 15"],["assess-opqrst-info","This cannot be assessed when GCS < 15"]]}],$=(m={"scene-size-up":{id:"T1",before:["primary-survey"],beforeOp:"",after:[],afterOp:"",type:"policy"},"primary-survey":{id:"T2a",before:["secondary-assessment"],beforeOp:"",after:[],afterOp:"",type:"policy"},"intv-control-severe-bleeding-technique-direct-pressure":{id:"T2b",before:["secondary-assessment"],beforeOp:"",after:[],afterOp:"",type:"policy"},"intv-control-severe-bleeding-technique-2nd-tourniquet":{id:"T2c",before:["secondary-assessment"],beforeOp:"",after:[],afterOp:"",type:"policy"},"intv-control-severe-bleeding-technique-tourniquet":{id:"T2d",before:["secondary-assessment"],beforeOp:"",after:[],afterOp:"",type:"policy"},"ints-call-for-helicopter":{id:"T3",before:["secondary-assessment"],beforeOp:"",after:[],afterOp:"",type:"policy"},"required-action-obtains-vitals":{id:"T4",before:["secondary-assessment"],beforeOp:"",after:[],afterOp:"",type:"policy"},"required-action-attempt-obtain-sample":{id:"T5a",before:["secondary-assessment"],beforeOp:"",after:[],afterOp:"",type:"policy"},"required-action-obtain-OPQRST":{id:"T5b",before:["secondary-assessment"],beforeOp:"",after:[],afterOp:"",type:"policy"},"intv-transfer":{id:"T7",before:["secondary-assessment"],beforeOp:"",after:["airway","breathing","circulation"],afterOp:"",type:"policy"},"trauma-expose":{id:"T8",before:["chest"],beforeOp:"or",after:[],afterOp:"",type:"policy"},"general-impression":{id:"T9",before:["airway","breathing","circulation"],beforeOp:"and",after:[],afterOp:"",type:"policy"},"intv-spinal-immobilization-technique-manual-c-spine":{id:"T10a",before:["airway"],beforeOp:"",after:[],afterOp:"",type:"policy"},"intv-spinal-immobilization-technique-cervical-collar":{id:"T10b",before:["airway"],beforeOp:"",after:[],afterOp:"",type:"policy"},"intv-airway-patency-technique-suction-airway":{id:"T13",before:["secondary-assessment"],beforeOp:"",after:["airway"],afterOp:"",type:"policy"}},Object(q.a)(m,"intv-airway-patency-technique-suction-airway",{id:"T14",before:["intv-oropharyngeal-airway","intv-nasopharyngeal-airway"],beforeOp:"or",after:[],afterOp:"",type:"policy"}),Object(q.a)(m,"intv-oropharyngeal-airway",{id:"T15a",before:["intv-nasotracheal-intubation","intv-orotracheal-intubation","intv-sedation-assisted-intubation","intv-rapid-sequence-intubation"],beforeOp:"or",after:[],afterOp:"",type:"policy"}),Object(q.a)(m,"intv-nasopharyngeal-airway",{id:"T15b",before:["intv-nasotracheal-intubation","intv-orotracheal-intubation","intv-sedation-assisted-intubation","intv-rapid-sequence-intubation"],beforeOp:"or",after:[],afterOp:"",type:"policy"}),Object(q.a)(m,"intv-ventilation-technique-bag-valve-mask",{id:"T17",before:["secondary-assessment"],beforeOp:"",after:[],afterOp:"",type:"policy"}),m),ee={"assess-major-bleeding":{id:"c1",before:["airway","breathing"],beforeOp:"",after:[],afterOp:"",type:"policy"},"intv-transport":{id:"T2-c1",before:["into-establish-IV","intv-control-shock-technique-administer-iv-boluses"],beforeOp:"and",after:[],afterOp:"",type:"policy"},"secondary-assessment":{id:"T6-c1",before:["intv-transfer","ongoing-mgmt-plan"],beforeOp:"",after:[],afterOp:"",type:"policy"},"pulse-checks":{id:"T12-c1",before:["airway"],beforeOp:"or",after:[],afterOp:"",type:"policy"}},te={M2CA:["c1","T6-c1"],B4CA:[],B7CA:[],SC8CP:["T2-c1","T6-c1","T12-c1"]},ne={"intv-nasopharyngeal-airway":{intvStatusNeeded:!0,vitalsNeeded:[]},"intv-oropharyngeal-airway":{intvStatusNeeded:!0,vitalsNeeded:[]},"intv-orotracheal-intubation":{intvStatusNeeded:!0,vitalsNeeded:[]},"intv-ventilation-technique-bag-valve-mask":{intvStatusNeeded:!1,vitalsNeeded:["R","Spo2","BP","Skin"]},"intv-sedation-assisted-intubation":{intvStatusNeeded:!1,vitalsNeeded:["R","Spo2","BP","Skin"]},"intv-control-severe-bleeding-technique-direct-pressure":{intvStatusNeeded:!0,vitalsNeeded:[]},"intv-control-severe-bleeding-technique-tourniquet":{intvStatusNeeded:!0,vitalsNeeded:[]},"intv-control-severe-bleeding-technique-2nd-tourniquet":{intvStatusNeeded:!0,vitalsNeeded:[]}};var re=function(e,t){t.includes(e)||t.push(e)},ie=function(e){var t=[],n=[];e.forEach((function(e){re(e,t)}));for(var r=0,i=Object.entries(J);r<i.length;r++){var o=Object(u.a)(i[r],2),s=o[0];0!==o[1].filter((function(e){return t.includes(e)})).length&&re(s,n)}return 1===n.length?n[0]:"errors"},oe=function(e){for(var t=[],n=0,r=Object.entries(Q);n<r.length;n++){var i=Object(u.a)(r[n],2),o=i[0];i[1][0]===e&&t.push(o)}return t},se=function(e,t){var n="";if("header"===e.type?(n=Q[e.displayColor])||(n=Q[e.status]):n=Q[e.status]?Q[e.status]:Q.default,n)return n[t]},ae=function(e){return G[se(e,0)]},ce=function(e){if(e){var t,n=e.split(" "),r=n.length;n.forEach((function(e,t){var i=e.trim();"."===i[e.length-1]&&t<r-1&&(i+="\xa0\xa0"),n[t]=i}));var i,o=Object(Y.a)(n);try{for(o.s();!(i=o.n()).done;){var s=i.value;t=t?t+" "+s:s}}catch(a){o.e(a)}finally{o.f()}return t}return""},de=function(e){e.intvStatus&&e.intvStatus.length>0&&(e.intvStatusFB=function(e){var t,n,r=[],i=[],o=Object(Y.a)(e.intvStatus);try{for(o.s();!(n=o.n()).done;){var s=n.value;s.foundCk?r.push(s.label):i.push(s.label)}}catch(a){o.e(a)}finally{o.f()}return i.length>0&&(t="Remember to check the effect of this action by asking for: "+i+".",r.length>0&&(t=t+" That is in addition to what you did ask for: "+r+".")),t}(e));var t,n=ce(se(e,1)).trim().split(" ");n.forEach((function(t,r){var i=t.charAt(0),o=t.substring(1);switch(n[r]=n[r].trim(),i){case"@":e[o]?n[r]=ce(e[o]):n[r]="[value for "+o+" is missing]";break;case"?":e[o]?n[r]=ce(e[o]):(n[r]="","+bos"===n[r-1]&&(n[r-1]="","."!==n[r-2][n[r-2].length-1]&&(n[r-2]=n[r-2]+".\xa0")),"+eos"===n[r+1]&&(n[r+1]=""))}})),n.forEach((function(e,t){var r="";switch(e.charAt(0)){case"+":switch(e.substring(1)){case"eos":"."===(r=n[t-1].trim())[r.length-1]&&(r=r.slice(0,-1)),n[t-1]=r+".\xa0",n[t]="";break;case"bos":"."===(r=n[t-1].trim())[r.length-1]&&(r=r.slice(0,-1)),n[t-1]=r+".\xa0",n[t]="";var i=n[t+1].trim();n[t+1]=i.charAt(0).toUpperCase()+i.slice(1)}}}));var r,i=Object(Y.a)(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;t?""!==o&&(t=t+"\xa0"+o):""!==o&&(t=o)}}catch(s){i.e(s)}finally{i.f()}return t},le={},ue=function(e,t,n){return e.filter((function(e){return e[t]===n}))},pe=function(e,t,n){return ue(ue(e,"timestamp",n),"id",t)},he=n(34),be=function(e,t,n,r,i){console.log("In savingDebriefingLog");var o=O.collection("debriefing-feedback-logs").doc(e.id),s={userName:e.userName,ObserverFileCreater:e.userName,label:e.label,ObserverFileName:e.label,commenter:"",scenarioID:e.scenarioID,scenarioName:e.scenarioName,schemaVersion:e.schemaVersion,timestamp:Date().toLocaleString(),hierAssessResults:n,hierProblemResults:r,constraintsViolated:i},a=[],c={},d=!1;t.forEach((function(e,t){for(var n=0,r=Object.entries(e);n<r.length;n++){var i=Object(u.a)(r[n],2),o=i[0],s=i[1];void 0===s&&(console.log("filtered out from events; index: ",t," key: ",o," value: ",s),d=!0)}})),d?(t.forEach((function(e,t){c=he.pickBy(e,(function(e,t){return!(void 0===e)})),a.push(c)})),s.events=a):s.events=t,o.set(s)},fe=function(e){return"criticalActionHeader"===e.status?"":-1===e.timestamp?"\xa0\xa0":(t=e.timestamp,new Date(1e3*t).toISOString().substr(14,5));var t},me=function(e,t){return e.reduce((function(e,n){return Object(w.a)(Object(w.a)({},e),{},Object(q.a)({},n[t],(e[n[t]]||[]).concat(n)))}),{})},ve=function(e,t){return e.checkListMetaData.filter((function(e){return e.type===t}))},Oe=[],ge=[],je=function(e,t,n,r){var i=ye(e,t);if(i){var o=[i],s=[],a=[];if(r){var c;if(2===n&&(c=t.filter((function(t){return t.inPhase===e&&"header"!==t.type}))),1===n){c=t.filter((function(e){return e.phaseID===i.id&&"header"===e.type&&"assessmentSubHeader"===e.subtype}));var d,l=Object(Y.a)(c);try{for(l.s();!(d=l.n()).done;){var u=d.value;s.includes(u.id)||(s.push(u.id),a.push(u))}}catch(p){l.e(p)}finally{l.f()}c=a}o=o.concat(c)}return o}return!1},ye=function(e,t){var n,r="unk",i=[],o=t.filter((function(t){return"header"===t.type&&t.id===e})),s=o[0],a=Object(Y.a)(o);try{for(a.s();!(n=a.n()).done;){var c=n.value;re(c.status,i)}}catch(d){a.e(d)}finally{a.f()}return i.length>0&&(r=1===i.length?i[0]:"errors"),s&&(s.status=r),s};function we(e){if(["irrelevant","unnecessary"].includes(e.status))return{};var t={};return e.labelID?t.id=e.labelID:t.id=e.id,"header"===e.type&&(t.subtype=e.id),e.expertPhase&&(t.inPhase=e.expertPhase),["label","status","phaseOrderStatus","phase","subPhase","labelID","phaseID","probLabel","answerCorrect","answerDetails","timestamp","type"].forEach((function(n){e[n]&&(t[n]=e[n])})),X.good.includes(t.status)&&(t.status="good"),X.absent.includes(t.status)&&(t.status="absent"),t}var Pe=function(e,t,n,r,i){Oe=[],ge=[];var o={},s={};e.forEach((function(e){"intervention"!==e.type&&"answer"!==e.type?Oe.push(we(e)):ge.push(we(e))})),t.forEach((function(e){var t=ge.filter((function(t){return t.probLabel===e.probLabel&&"header"!==t.type})),n=t.map((function(e){return e.status})),r=ie(n),i={id:e.probLabel,probLabel:e.probLabel,status:r,phaseOrderStatus:"good",subtype:"interventionHeader",type:"header"};t&&(s[e.probLabel]=[i].concat(t))}));var a,c,d,l=n,p=r.filter((function(e){return!l.includes(e)}));l.forEach((function(e){var t=je(e,Oe,2,!0);t&&(o[e]=t)})),p.forEach((function(e){var t=je(e,Oe,1,!0);t&&(o[e]=t)}));var h=Object(w.a)(Object(w.a)({},o),s);return i.forEach((function(t){"header"===(c=e.filter((function(e){return!!e.labelID&&e.labelID===t.arg1.id||e.id===t.arg1.id}))[0]).type?(d=h[c.labelID],a=d[0]):(d="intervention"===c.type?h[c.probLabel]:h[c.workingPhase],a=d.filter((function(e){return e.id===t.arg1.id}))[0]),a&&("phase"===t.type?(a.phaseOrderStatus="misOrdered",a.arg2?a.arg2=a.arg2.concat([t.arg2.id]):a.arg2=[t.arg2.id]):a.arg2?a.arg2=a.arg2.concat([t.arg2.id]):a.arg2=[t.arg2.id])})),function(e){for(var t,n=["good"],r=0,i=Object.entries(e);r<i.length;r++){var o=Object(u.a)(i[r],2),s=(o[0],o[1]);if("assessmentHeader"===s[0].subtype&&"good"===s[0].status){var a,c=Object(Y.a)(s.slice(1));try{for(c.s();!(a=c.n()).done;){var d=a.value;d.phaseOrderStatus&&re(d.phaseOrderStatus,n)}}catch(l){c.e(l)}finally{c.f()}(t=1===n.length?n[0]:"errors")&&(s[0].status=t)}}}(o),console.log("top-level-analysis: ",function(e,t){var n,r={},i=[],o=Object(w.a)(Object(w.a)({},e),t),s={id:"top",probLabel:"top",status:"errors",phaseOrderStatus:"good",type:"header"};return i.push(s),De.forEach((function(e){(n=o[e])&&(r[e]=n,i.push(n[0]))})),Se.forEach((function(e){(n=o[e])&&(r[e]=n)})),r.top=i,r}(o,s)),[o,s]},De=["scene-size-up","Manage a potential head and/or spinal injury","primary-survey","ongoing-mgmt-plan"],Se=["airway","breathing"];var xe,Ee,Ie,ke,Ne,Te,Ae,Fe,Ce,Re,Be=oe("Problem"),Le=oe("Caution"),qe={};function Me(e){Ae=e,function(e){var t=te[e];le=$;for(var n=0,r=Object.entries(ee);n<r.length;n++){var i=Object(u.a)(r[n],2),o=i[0],s=i[1];t.includes(s.id)&&(le[o]=s)}}(e.name),Fe=_e(e),Ce=We(e),Ne=ve(e,A.PHASE).map((function(e){return e.id})).concat(["Unknown"]),ke=ve(e,A.SUB_PHASE).map((function(e){return e.id})),Re=function(e){var t=ve(e,A.PHASE),n=ve(e,A.SUB_PHASE),r=e.checkListMetaData.filter((function(e){return C.includes(e.type)})),i=e.checkListMetaData.filter((function(e){return R.includes(e.type)})),o=me(i,"parentID");r.forEach((function(e){e.id in o&&(e.options=o[e.id])}));var s=me(r.filter((function(e){return void 0===e.subPhase})),"phase"),a=me(r.filter((function(e){return!!e.subPhase})),"subPhase");n.forEach((function(e){e.items=a[e.id]}));var c=me(n,"phase");return t.forEach((function(e){e.id in s?e.items=s[e.id]:e.subPhases=c[e.id]})),t}(e),Te=He(Re),Re.forEach((function(e){void 0===e.subPhases?qe[e.id]=e.label:e.subPhases.forEach((function(t){qe[t.id]=e.label}))})),qe.Unknown="Unknown",xe={},Ee={},Ie=[]}var _e=function(e){var t,n=me(e.checkListMetaData.filter((function(e){return B.includes(e.type)})),"id");return t=e.interventions?me(e.interventions,"id"):me(e.intvMetaData.filter((function(e){return B.includes(e.type)})),"id"),Object.assign(n,t)},We=function(e){var t,n=me(e.checkListMetaData.filter((function(e){return B.includes(e.type)})),"label");return t=e.interventions?me(e.interventions,"label"):me(e.intvMetaData.filter((function(e){return B.includes(e.type)})),"label"),Object.assign(n,t)},He=function(e){var t=[];return e.forEach((function(e){if(e.subPhases){var n=e.subPhases.map((function(e){return e.id}));t=t.concat(n)}else t=t.concat(e.id)})),t},Ue=function(e,t,n,r){for(var i=void 0,o=void 0,s=0;s<e.length&&(n.id!==e[s]||(i=t[s],"start"!==r));s++);return i&&(o=-1===i.numericalID?"start"===r?i.numericalIDStart:i.numericalIDEnd:i.numericalID),o},Ve={id:"Unknown",label:"Unknown"},ze=function(e){if("Unknown"===e)return Ve;var t=Fe[e];return t||(t=Ce[e]),t?t[0]:void 0},Ye=function(e,t,n){for(var r=0;r<n.length;r++){var i=t[r],o=n[r];if(i.length>0&&!tt(o)){var s,a=Object(Y.a)(i);try{for(a.s();!(s=a.n()).done;){var c=s.value;if(c.numericalID===e)return c}}catch(d){a.e(d)}finally{a.f()}}}},Ge=function(e,t,n,r){var i=Ye(e,n,r);i?i.arg2?i.arg2=i.arg2.concat([t.id]):i.arg2=[t.id]:console.log("no object found for numericalID = ",e)},Ke=function(e,t,n){var r;return r=["phase","sub-phase"].includes(e.type)?"phase":"item",Ie.push({constraintID:n,arg1:e,op:"before",arg2:t,type:r}),r},Qe=function(e,t,n,r){return r&&(e+=t?" and ":", "),e+=n.toLowerCase()},Je=function(e,t,n,r,i,o,s,a,c){var d,l=Ue(o,s,e,"end"),u=Ue(o,s,e,"start"),p=e.label,h="",b="",f="";if(t.length>0){var m,v=0,O=0,g=Object(Y.a)(t);try{for(g.s();!(m=g.n()).done;){var j=m.value,y=!1,w=ze(j);if(w){++v===t.length&&(y=!0);var P=w.label,D=Ue(o,s,w,"start"),S=Ue(o,s,w,"end");switch(r){case"before":if(l&&D)if(l<D){if("or"===n)return}else O++,""===b&&(b=Qe(b=u===l?"You should have done ":"You should have completed ",y,p,!1)),D===S?(""===f&&(f+=" before you did "),f=Qe(f,y,P,O>1)):(""===f&&(f+=" before starting "),f=Qe(f,y,P,O>1)),Ge(u,w,a,c),d=Ke(e,w,i);break;case"after":if(u&&S)if(u>S){if("or"===n)return}else O++,u===l?(""===b&&(b="You should have done "),b=Qe(b,y,P,O>1)):(""===b&&(b="You should have completed "),b=Qe(b,y,P,O>1)),""===f&&(f=Qe(f+=D===S?" before you did ":" before starting ",y,p,!1)),Ge(D,e,a,c),d=Ke(w,e,i)}}}}catch(x){g.e(x)}finally{g.f()}""!==(h=b+f)&&function(e,t,n,r,i){var o=Ye(e,r,i);if(o){var s;""!==o.orderingFB?o.orderingFB=o.orderingFB+".\xa0\xa0"+t:o.orderingFB=t;var a="";"phase"===n&&(a="misOrdered-phase-"),"item"===n&&(a="misOrdered-"),o.status.includes(a)||(s=a+o.status,o.status=s)}else console.log("no object found for numericalID = ",e)}(u,h,d,a,c)}},Xe=function(e,t){var n=function(e,t){for(var n=[],r=[],i=[],o=0;o<t.length;o++){var s=e[o],a=t[o],c=s[0].numericalID,d=s[s.length-1].numericalID;if((Ne.includes(a)||ke.includes(a))&&(r.push({id:a,numericalID:-1,numericalIDStart:c,numericalIDEnd:d}),n.push(a),i.includes(a)||i.push(a)),s.length>0&&!tt(a)){var l=s.map((function(e){return e.id}));r=r.concat(s),i=i.concat(l),n=n.concat(l)}}return[n,i,r]}(e,t),r=n[0],i=n[1],o=n[2];return i.forEach((function(n){var i=ze(n);if(i){var s=function(e){var t=e.id,n=e.label,r=le[t];return r||(r=le[n]),r}(i);s&&function(e,t,n,r,i,o){var s=t.before,a=t.beforeOp;Je(e,s,a,"before",t.id,i,o,n,r),s=t.after,a=t.afterOp,Je(e,s,a,"after",t.id,i,o,n,r)}(i,s,e,t,r,o)}})),[e,t]},Ze=function(e,t,n,r){var i;i=n.when;var o=e.lastIndexOf(i),s=t[o];s||(s=[]),s.splice(r-1,0,n),t[o]=s},$e=function(e,t){var n=function(e,t){var n,r,i=et(e),o=Object(L.a)(i).reverse(),s=Object(Y.a)(o);try{var a=function(){var e=r.value;if(n=t.find((function(t){return t===e.id})))return"break"};for(s.s();!(r=s.n()).done&&"break"!==a(););}catch(c){s.e(c)}finally{s.f()}return n}(e,t);return t.lastIndexOf(n)},et=function(e){return Re.find((function(t){return t.id===e})).subPhases},tt=function(e){var t=Re.find((function(t){return t.id===e}));return!(!t||!t.subPhases)},nt=function(e,t){var n=t;return"red"===e&&(n="red"),"yellow"===e&&"red"!==n&&(n="yellow"),n},rt=function(e,t,n){var r=void 0;return void 0===(r=n?Ae.associations[e]:Ae.checkListCorrectness[e])?(console.log("didn't find answers for ",e),!1):Array.isArray(r)?!r.find((function(e){return e===t})):!(r===t)},it=function(e,t){var n,r;t?(n=Ae.associations[e],r=Ae.intvMetaData):(n=Ae.checkListCorrectness[e],r=Ae.checkListMetaData);var i=!1;return Array.isArray(n)?n.forEach((function(e,t){r.forEach((function(t,n){t.id!==e||(!1===i?i=t.label:i+=", ")}))})):r.forEach((function(e,t){e.id===n&&(i=e.label)})),i},ot=function(e,t){var n;n=t?Ae.intvMetaData:Ae.checkListMetaData;var r="";return n.forEach((function(t,n){t.id===e&&(r=t.label)})),r||!1},st=function(e,t,n,r,i){return e.forEach((function(e){var o=e.actions;o.forEach((function(s,a){if(!t.includes(s.id+"+"+e.probLabel)){t.push(s.id+"+"+e.probLabel);var c={comment:"",numericalID:n,status:"",intvStatus:[],required:!0,when:"",suggestedPhase:"",expertPhase:"",probLabel:"",minimalWhy:"",assessmentsNeeded:"",protocol:"",protocolRelationship:"",actionDescription:"",type:"intervention",timestamp:-1};["id","phase","why","protocolRelationship"].forEach((function(e){s[e]&&(c[e]=s[e])}));var d;["probLabel","minimalWhy"].forEach((function(t){e[t]&&(c[t]=e[t])})),e.assessments&&(c.assessmentsNeeded=e.assessments),e.protocols&&(c.protocol=e.protocols),s["id-label"]&&(c.label=s["id-label"]),s["id-label"]&&(c.actionDescription=s["id-label"]),s.subPhase&&(d=s.subPhase),s.phase&&!d&&(d=s.phase),d&&(c.when=d,c.expertPhase=d,c.suggestedPhase=d),c.status="missing"+((l=c.protocolRelationship).charAt(0).toUpperCase()+l.slice(1)),["optional","unnecessary","irrelevant"].includes(c.protocolRelationship)||(!function(e,t,n,r,i){var o=-1;""===n.expertPhase&&(n.expertPhase=Ne[Ne.length-2]),o=ke.includes(n.expertPhase)||!et(n.expertPhase)?e.lastIndexOf(n.expertPhase):$e(n.expertPhase,e),n.when=e[o];var s=r.slice(0,i-1),a=r[i-1],c=Object(L.a)(s).reverse().find((function(e){return e.required})),d=r[i+1],l=r.slice(i+1).find((function(e){return e.required})),u=Object(L.a)(t[o]),p=-1,h=-1,b=-1,f=-1,m=!1;a&&(p=u.findIndex((function(e){return e.id===a.id}))),d&&(h=u.findIndex((function(e){return e.id===d.id}))),c&&(b=u.findIndex((function(e){return e.id===c.id}))),l&&(f=u.findIndex((function(e){return e.id===l.id}))),d&&(h=u.findIndex((function(e){return e.id===d.id}))),-1!==b&&(m=b+2,p>b&&(m=p+2)),m||-1===f||(m=f+1,h<f&&(m=h+1)),m||-1===p||(m=p+2),m||-1===h||(m=h+1),m||(m=u.length+2),Ze(e,t,n,m)}(r,i,c,o,a),n++)}var l}))})),[n,r,i]};function at(e,t){var n=t.events;console.log("in analyzeEvents"),Me(e);var r=Ae.problems,i=Ae.actions,o=function(e,t,n){var r,i=[],o=Object(Y.a)(e);try{var s=function(){var e=r.value,o={},s=e.solutions[0];if(t&&n){var a=t.filter((function(t){return t.problemID===e.id})).filter((function(e){return e.id===s}));o.probLabel=e.label,o.id=e.id,o.lifeThreat=e.lifeThreat,o.vitals=e.vitals;var c,d=e.assessments;o.assessments=d.map((function(e){return e.assessmentID})),o.actions=[],o.otherActions=[];var l=a[0].actions;c=n.filter((function(e){return l.includes(e.id)}));var u,p=Object(Y.a)(c);try{for(p.s();!(u=p.n()).done;){var h=u.value,b=Object.assign({},h);b.id=b.interventionID;var f=Fe[b.id];switch(b["id-label"]=f?f[0].label:b.id,b.protocolRelationship){case"contraindicated":case"irrelevant":case"unnecessary":o.otherActions.push(b);break;case"required":case"minimal":case"optional":o.actions.push(b)}}}catch(m){p.e(m)}finally{p.f()}o.minimalWhy=a.minimalWhy,o.protocols=a.protocols}else o.probLabel=e.problem,o.lifeThreat=e.lifeThreat,o.actions=s.actions,o.minimalWhy=s.minimalWhy,o.protocols=s.protocols,o.assessments=e.assessments,o.otherActions=s.contraindications,o.actions.forEach((function(e){e.minimal&&(e.protocolRelationship="minimal"),e.optional&&(e.protocolRelationship="optional"),e.minimal||e.optional||(e.protocolRelationship="required")})),o.otherActions.forEach((function(e){e.protocolRelationship="contraindicated"})),o.allProblemProtocols=e.protocol;i.push(o)};for(o.s();!(r=o.n()).done;)s()}catch(a){o.e(a)}finally{o.f()}return i}(r,Ae.solutions,i),s=[],a=function(e,t){var n=[],r=[],i=[],o=[],s=[],a={},c="",d="",l=0,u=0,p=!0,h=["assessment","required-action","decision-option","assessment-option"];return e.forEach((function(e,b){var f={comment:"",numericalID:b,status:"",intvStatus:[],contraindicatedWhy:"",minimalWhy:"",why:"",answerCorrect:!0,answerDetails:{},expertPhase:"",workingPhase:"",suggestedPhase:"",protocol:"",protocolRelationship:"",probLabel:"",assessments:"",required:!1,actionDescription:"",assessmentFB:"",incorrectAnswersFB:"",orderingFB:"",processingState:"good"};["id","label","finding","phase","subPhase","vitalType","vital","value","type","prompt","promptID","intervention","timestamp"].forEach((function(t){e[t]&&(f[t]=e[t])})),e.label&&(f.actionDescription=e.label),e.type&&(f.status=e.type),e.subPhase?f.workingPhase=e.subPhase:e.phase&&(f.workingPhase=e.phase),f.expertPhase=f.workingPhase,c===f.workingPhase&&d===f.phase||(""!==c&&h.includes(f.type)?(p=!0,o[u]=s,u!==l&&(o[l]=o[l].concat(s)),u++,f.phase!==d&&(d=f.phase,l=u,f.phase!==f.workingPhase&&(o[l]=[],i[l]=d,u++))):""===c&&h.includes(f.type)?(d=f.phase)!==f.workingPhase&&(d=f.phase,i[l]=d,u++):""===c?(d="Unknown",f.workingPhase=d,f.phase=d,f.subPhase=""):p=!1,p?(c=f.workingPhase,s=[],i[u]=c,o[u]=[]):p=!0);var m=f.type;["assessment","required-action","intervention","answer","obtain-vital-sign","decision-option","assessment-option"].includes(m)||(f.processingState="bad");var v=[];if("answer"===m){var O=it(e.promptID,!0),g=ot(e.id,!0);if(O){var j=rt(e.promptID,e.id,!0),y={correctAnswer:O,givenAnswer:g,correct:!j};n.includes(f.intervention)?(v=s.pop(),n.pop(),f.answerCorrect=v.answerCorrect,f.answerDetails=v.answerDetails,f.actionDescription=v.actionDescription+", "+g,j?(f.answerCorrect=!1,""===v.incorrectAnswersFB?f.incorrectAnswersFB="You should have responded: "+O:f.incorrectAnswersFB=v.incorrectAnswersFB+", and "+O):(f.incorrectAnswersFB=v.incorrectAnswersFB,f.answerCorrect=v.answerCorrect)):(j?(f.answerCorrect=!1,f.incorrectAnswersFB="You should have responded: "+O):f.incorrectAnswersFB="",n.push(f.intervention)),f.answerDetails[e.promptID]=y}else f.processingState="bad"}if("intervention"===m&&(v=s.slice(-1)[0])&&"answer"===v.type&&(v.intervention===f.id?(v=s.pop(),n.pop(),n.pop(),f.answerCorrect=v.answerCorrect,f.answerDetails=v.answerDetails,f.incorrectAnswersFB=v.incorrectAnswersFB,f.actionDescription=f.actionDescription+".\xa0\xa0"+v.actionDescription):(v=s.pop(),n.pop(),n.pop())),"good"===f.processingState){if("obtain-vital-sign"===f.type){var w=f.vital,P="";P="intervention-status"===f.vitalType?r.includes(w)?"intv":"noIntv":"vital";var D=a[w];switch(P){case"intv":f.status="patientIntvCheck",D&&D.timestamp<f.timestamp&&(D.foundCk=!0,a[w]=D);break;case"noIntv":f.status="intvCheckWNoIntvFound";break;case"vital":f.status="patientVitalCheck",D&&(D=function(e,t){var n=[];return e.forEach((function(e){e.timestamp<t&&(e.foundCk=!0),n.push(e)})),n}(D,f.timestamp),a[w]=D);break;default:f.status="unexpectedPatientIntvCheck"}}"intervention"===f.type&&t.forEach((function(e,t){var n,r,i=["why","probLabel","protocolRelationship"];null===(n=e.actions)||void 0===n||n.forEach((function(t,n){if(t.id===f.id){var r,o=f.id;if((r=ne[f.label])||(r=ne[f.id]),r){var s={intervention:o,timestamp:f.timestamp,foundCk:!1};r.intvStatusNeeded&&(a[o]=Object.assign({},s)),r.vitalsNeeded.forEach((function(e){a[e]?a[e].push(Object.assign({},s)):a[e]=[Object.assign({},s)]}))}t.assessments&&(f.assessmentsNeeded=t.assessments),t.phase&&(f.when=t.phase,f.suggestedPhase=t.phase),e.protocols&&(f.protocol=e.protocols),f.answerCorrect?f.status="goodIntv":f.status="incorrect-answers",f.probLabel=e.probLabel,i.forEach((function(e){t[e]&&(f[e]=t[e])})),t["id-label"]&&(f.label=t["id-label"])}})),null===(r=e.otherActions)||void 0===r||r.forEach((function(t,n){t.id===f.id&&(f.status=e.protocolRelationship,i.forEach((function(e){t[e]&&(f[e]=t[e])})),e.probLabel&&(f.probLabel=e.probLabel))}))})),"decision-option"===f.type&&rt(e.promptID,e.id,!1)&&(f.status="decision-option-incorrect",f.answerCorrect=!1,f.incorrectAnswerFB="You should have responded "+it(e.promptID,!1)),"assessment-option"===f.type&&rt(e.promptID,e.id,!1)&&(f.status="assessment-option-incorrect",f.answerCorrect=!1,f.incorrectAnswerFB="You should have responded "+it(e.promptID,!1)),"intervention"===f.type?(n.push(f.id+"+"+f.probLabel),r.push(f.id)):n.push(f.id),s.push(f)}})),o[u]=s,u!==l&&(o[l]=o[l].concat(s)),[o,i,n,a]}(n,o),c=a[0],d=a[1],l=a[2],p=a[3],h=Xe(c,d),b=function(e,t){var n;return Te.forEach((function(r,i){if(!t.includes(r)){var o=0;(n=0===i?Te[0]:Te[i-1])!==r&&(o=t.lastIndexOf(n),o+=1),t.splice(o,0,r),e.splice(o,0,[])}})),[e,t]}(c=h[0],d=h[1]);c=b[0],d=b[1];var f=function(e,t,n,r,i){var o,s=function(e){var t=[];return e.forEach((function(e){""!==e.assessments&&(t=t.concat(e.assessments))})),t}(e),a=t.length,c=Ae.checkListMetaData.filter((function(e){return[A.ASSESS,A.REQUIRED].includes(e.type)})),d=[],l=Object(Y.a)(Z);try{for(l.s();!(o=l.n()).done;){var u=o.value;if(u.scenarioName===Ae.name){d=u.exceptions;break}}}catch(p){l.e(p)}finally{l.f()}return d.forEach((function(e,t){c=c.filter((function(t){return t.id!==e[0]})),n.includes(e[0])&&i.forEach((function(t,n){t.forEach((function(t,n){t.id===e[0]&&(t.why=e[1],t.status="notNecessary")}))}))})),c.forEach((function(e,t){if(!n.includes(e.id)){n.push(e.id);var o={comment:"",numericalID:a,status:"missingRequiredAssessment",intvStatus:[],expertPhase:"",workingPhase:"",contraindicatedWhy:"",minimalWhy:"",why:"",probLabel:"",protocol:"",actionDescription:"",assessmentFB:"",timestamp:-1};["id","label","finding","phase","subPhase","type","prompt"].forEach((function(t){e[t]&&(o[t]=e[t])})),e.subPhase?o.workingPhase=e.subPhase:e.phase&&(o.workingPhase=e.phase),o.when=o.workingPhase,o.expertPhase=o.workingPhase,o.label&&(o.actionDescription=o.label),s.includes(e.id)&&(o.assessmentFB="Thus you missed finding: "+Ae.assessmentFindings[e.id]),"required-action"===o.type&&(o.status="missingRequiredAssessment"),Ze(r,i,o,t),a++}})),[n,r,i,a]}(o,n,l,d,c);l=f[0],d=f[1],c=f[2];var m=f[3],v=st(o,l,m,d,c);m=v[0],d=v[1],c=v[2],s=function(e,t){for(var n,r=0,i=Object.entries(t);r<i.length;r++){var o=Object(u.a)(i[r],2),s=o[0],a=o[1];if(Array.isArray(a)){var c,d=Object(Y.a)(a);try{for(d.s();!(c=d.n()).done;){var l=c.value,p={label:s,foundCk:l.foundCk};n=pe(e,l.intervention,l.timestamp);var h,b=Object(Y.a)(n);try{for(b.s();!(h=b.n()).done;){var f=h.value;f.intvStatus.includes(p)||f.intvStatus.push(p)}}catch(m){b.e(m)}finally{b.f()}}}catch(m){d.e(m)}finally{d.f()}}else!function(){var t={label:"intervention status",foundCk:a.foundCk};(n=pe(e,s,a.timestamp)).forEach((function(e){e.intvStatus.includes(t)||e.intvStatus.push(t)}))}()}return e}(s=function(e,t){for(var n=[],r=1,i=1,o="green",s="green",a=[],c=[],d=[],l={id:"assessmentHeader",status:"",phaseOrderStatus:"good",type:"header",numericalID:1,displayColor:"",why:"",label:"",labelID:"",protocol:""},u={id:"assessmentSubHeader",status:"",phaseOrderStatus:"good",type:"header",numericalID:1,displayColor:"",why:"",label:"",labelID:"",phaseID:"",protocol:""},p="",h=!1,b=0;b<e.length;b++){var f=t[b],m=e[b],v=!0;if(Ne.includes(m)&&tt(m)&&(v=!1),f.length>0&&v){var O=t[b];s="green";var g,j=Object(Y.a)(O);try{for(j.s();!(g=j.n()).done;){var y=g.value;"intervention"!==y.type&&a.push(y.status),Be.includes(y.status)&&(s="red"),Le.includes(y.status)&&"red"!==s&&(s="yellow"),y.numericalID=r++}}catch(C){j.e(C)}finally{j.f()}var w=Object.assign({},u),P=e[b],D=ze(P);w.label=D.label,w.labelID=D.id,w.status=ie(a),w.displayColor=s;var S=qe[P],x=ze(S);if(w.phaseID=x.id,""===p&&(p=x,o=nt(s,o)),b===e.length-1){var E=Object.assign({},l);S!==p.label&&(E.label=p.label,E.labelID=p.id,E.status=ie(c),E.displayColor=o,E.numericalID=i++/1e3,n.push(E),n.push.apply(n,Object(L.a)(d)),d=[]),(E=Object.assign({},w)).label=x.label,E.labelID=x.id,E.id="assessmentHeader",E.numericalID=i++/1e3,n.push(E),S===w.label?(n.push.apply(n,Object(L.a)(d)),n.push.apply(n,Object(L.a)(O))):(w.numericalID=i++/1e3,n.push.apply(n,Object(L.a)(d)),n.push(w),n.push.apply(n,Object(L.a)(O))),h=!0}if(!h)if(S!==p.label){var I,k,N=Object.assign({},l);N.label=p.label,N.labelID=p.id,N.status=ie(c),c=[],N.displayColor=o,N.numericalID=i++/1e3,n.push(N),n.push.apply(n,Object(L.a)(d)),(I=c).push.apply(I,Object(L.a)(a)),a=[],S===w.label?d=Object(L.a)(O):(w.numericalID=i++/1e3,(k=d=[w]).push.apply(k,Object(L.a)(O))),p=x,o=nt(s,"green")}else{var T,A,F;o=nt(s,o),(T=c).push.apply(T,Object(L.a)(a)),a=[],S===w.label?(A=d).push.apply(A,Object(L.a)(O)):(w.numericalID=i++/1e3,d.push(w),(F=d).push.apply(F,Object(L.a)(O)))}}}return n}(d,c),p);var O=[];s.forEach((function(e,t){O.push(e)}));var g=[],j=[],y=0,w=-1;O.forEach((function(e,t){if("intervention"===e.type&&e.status&&e.status.includes("goodintv","incorrect-answers","minimal","misOrdered-goodintv","misOrdered-incorrect-answers","misOrdered-incorrect-answers","minimal","misOrdered-minimal","misOrdered-minimal-incorrect-answers","misOrdered-phase-incorrect-answers","misOrdered-phase-minimal-incorrect-answers","misOrdered-phase-minimal")){j.includes(e.probLabel)?w=j.indexOf(e.probLabel):(j[w=y]=e.probLabel,y++);var n=g[w];n||(n=[]),n.push(e),g[w]=n}}));var P=s.map((function(e){return e.id})),D=o.map((function(e){return e.probLabel}));j.forEach((function(e,t){var n=D.indexOf(e),r=o[n],i=r.actions.filter((function(e){return"required"===e.protocolRelationship})).map((function(e){return e.id})),a=r.actions.filter((function(e){return"minimal"===e.protocolRelationship})).map((function(e){return e.id}));if(a){var c,d=g[t].map((function(e){return e.id})),l=!0,u=!0,p=Object(Y.a)(i);try{for(p.s();!(c=p.n()).done;){var h=c.value;if(!d.includes(h)){l=!1;break}}}catch(j){p.e(j)}finally{p.f()}var b,f=Object(Y.a)(a);try{for(f.s();!(b=f.n()).done;){var m=b.value;if(!d.includes(m)){u=!1;break}}}catch(j){f.e(j)}finally{f.f()}var v=[];if(!l&&u){a.forEach((function(e,t){var n=P.indexOf(e),i=s[n];switch(i.minimalWhy=r.minimalWhy,i.status){case"incorrect-answers":i.status="minimal-incorrect-answers";break;case"goodintv":i.status="minimal";break;case"misOrdered-goodintv":i.status="misOrdered-minimal";break;case"misOrdered-incorrect-answers":i.status="misOrdered-minimal-incorrect-answers";break;case"misOrdered-phase-goodintv":i.status="misOrdered-phase-minimal";break;case"misOrdered-phase-incorrect-answers":i.status="misOrdered-phase-minimal-incorrect-answers"}v.push(i.numericalID),s[n]=i}));var O={};v.forEach((function(e,t){(O=function(e,t){var n,r={},i={},o=Object(Y.a)(t);try{for(o.s();!(n=o.n()).done;){var s=n.value;if("problemHeader"===s.id)r=s;else if(s.numericalID===e){i=r;break}}}catch(j){o.e(j)}finally{o.f()}return i}(e,s))&&"green"===O.displayColor&&(O.displayColor="yellow")}))}}}));var S=Pe(O,o,Te,Ne,Ie);return xe=S[0],Ee=S[1],console.log("Phase Assessment Status Results",xe),console.log("Intervention Status Results",Ee),console.log("Constraint Violation Results",Ie),be(t,O,xe,Ee,Ie),O}var ct=n(67),dt=n(63),lt=n(64),ut=n(65),pt=n(66),ht=function(e){var t=e.title,n=e.leftNav,r=void 0===n?null:n,o=e.rightNav,s=void 0===o?null:o,a=Object(i.useContext)(l.AuthContext),c=a.isAuthenticated,d=a.userName,u=a.signOutUser;return Object(V.jsxs)(dt.a,{color:"dark",dark:!0,children:[Object(V.jsx)(lt.a,{href:"#",children:"MedDBriefer"}),!!r&&Object(V.jsx)(ut.a,{children:r}),!!t&&Object(V.jsx)(pt.a,{tag:"h3",children:t}),Object(V.jsxs)(ut.a,{children:[c&&Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)(pt.a,{children:["Welcome, ",d," \xa0"]}),Object(V.jsx)(ct.a,{color:"danger",onClick:u,children:"Sign Out"})]}),!!s&&s]})]})},bt=function(e){var t=e.log,n=e.actions,r=e.scenario,o=e.context,s=Object(i.useState)(!1),a=Object(u.a)(s,2),c=a[0],d=a[1],l=Object(i.useState)(void 0),p=Object(u.a)(l,2),h=p[0],b=p[1];function f(e){return Object(V.jsx)(V.Fragment,{children:"obtain-vital-sign"===e.type?v(e):O(e)})}function m(e){var t=r.intvMetaData.find((function(t){return e.vital===t.id}));return Object(V.jsx)(V.Fragment,{children:t.label})}function v(e){return Object(V.jsx)(V.Fragment,{children:"intervention-status"===e.vitalType?Object(V.jsxs)(V.Fragment,{children:["Requested intervention status for: ",m(e),", ",Object(V.jsxs)("p",{children:["Found: ",Object(V.jsx)("i",{children:e.value})]})]}):Object(V.jsxs)(V.Fragment,{children:["Requested vital: ",e.vital,", ",Object(V.jsxs)("p",{children:["Found: ",Object(V.jsx)("i",{children:e.value})]})]})})}function O(e){return Object(V.jsx)(V.Fragment,{children:e.subPhase&&"intervention"!==e.type?Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)("b",{children:[e.subPhase,":"]})," ",e.actionDescription,".  ",w(e)]}):Object(V.jsx)(V.Fragment,{children:g(e)})})}function g(e){return Object(V.jsx)(V.Fragment,{children:"intervention"===e.type?Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("b",{children:"Intervention:"})," ",e.actionDescription,". ",w(e)," "]}):Object(V.jsxs)(V.Fragment,{children:[e.actionDescription,".  ",w(e)]})})}function w(e){return Object(V.jsx)(V.Fragment,{children:e.finding?Object(V.jsxs)("p",{children:["\xa0\xa0\xa0\xa0\xa0Findings: ",Object(V.jsx)("i",{children:e.finding})]}):Object(V.jsx)(V.Fragment,{})})}function P(e){var t=e.target.defaultValue,n=e.target.value,r=e.target.id;if(t!==n){var i=h.find((function(e){return e.id===r})),o=Object.assign({},i,{comment:n});S(o)}}var D=function(e){return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("td",{children:e.numericalID}),Object(V.jsx)("td",{children:fe(e)}),Object(V.jsxs)("td",{className:ae(e),children:[Object(V.jsx)("span",{className:"material-icons-outlined",children:(t=e,K[se(t,0)])}),f(e)]}),Object(V.jsx)("td",{children:de(e)}),c&&Object(V.jsx)("td",{children:Object(V.jsx)("textarea",{rows:"2",cols:"50",defaultValue:e.comment,onBlur:P,id:"".concat(e.id)})})]});var t},S=function(e){var t=h.findIndex((function(t){return t.id===e.id}));b([].concat(Object(L.a)(h.slice(0,t)),[e],Object(L.a)(h.slice(t+1))))};function x(){return(x=Object(y.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d("review"===o),b(n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(i.useEffect)((function(){!function(){x.apply(this,arguments)}()}),[]),void 0===h?Object(V.jsx)("h3",{children:"processing"}):Object(V.jsxs)(V.Fragment,{children:["review"===o?Object(V.jsx)(V.Fragment,{children:Object(V.jsx)(ht,{title:"Review of: ".concat(t.label),leftNav:Object(V.jsx)(ct.a,{color:"primary",onClick:function(){be(t,h)},children:"Save Debriefing Log"}),rightNav:Object(V.jsx)(ct.a,{color:"primary",onClick:function(){d(!c)},children:"Toggle Comments"})})}):Object(V.jsx)(V.Fragment,{children:Object(V.jsx)(ht,{title:"Analysis for: ".concat(t.label)})}),Object(V.jsx)("form",{children:Object(V.jsx)("div",{style:{overflowY:"auto",maxHeight:"700px"},children:Object(V.jsxs)(U.a,{borderless:!0,size:"sm",children:[Object(V.jsx)("thead",{children:Object(V.jsxs)("tr",{children:[Object(V.jsx)("th",{className:"table-header",children:" ID "}),Object(V.jsx)("th",{className:"table-header",children:" Timestamp "}),Object(V.jsx)("th",{className:"table-header",children:" Action Description "}),Object(V.jsx)("th",{className:"table-header",children:" Feedback "}),c&&Object(V.jsx)("th",{className:"table-header",children:" Comments "})]})}),Object(V.jsx)("tbody",{className:"scrolling",children:h.map((function(e,t){return Object(V.jsx)("tr",{children:"header"===e.type?(n=e,Object(V.jsx)(V.Fragment,{children:"assessmentHeader"===n.id||"assessmentSubHeader"===n.id?Object(V.jsx)("td",{colSpan:"4",className:ae(n),children:Object(V.jsx)("b",{children:n.label})}):Object(V.jsx)("td",{colSpan:"10",className:"black",children:Object(V.jsx)("div",{children:Object(V.jsxs)("em",{children:["\xa0\xa0\xa0Intervention Group: ",n.probLabel]})})})})):D(e)},t);var n}))})]})})})]})};var ft=function(){var e=Object(d.m)().logID,t=Object(i.useState)(void 0),n=Object(u.a)(t,2),r=n[0],o=n[1],s=Object(i.useState)(void 0),a=Object(u.a)(s,2),c=a[0],l=a[1],p=Object(i.useState)(void 0),h=Object(u.a)(p,2),b=h[0],f=h[1],m=Object(i.useState)(!1),v=Object(u.a)(m,2),g=v[0],w=v[1],P=Object(i.useState)(!1),D=Object(u.a)(P,2),S=D[0],x=D[1];function E(){window.confirm("Are you sure you want to overwrite the existing analysis?  Any prior comments previously added will be lost.")&&I(b,r)}function I(e,t){return k.apply(this,arguments)}function k(){return(k=Object(y.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:at(t,n);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return(N=Object(y.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_(O,"debriefing-feedback-logs",e);case 2:if(t.sent){t.next=7;break}I(b,r),w(!0),t.next=8;break;case 7:E();case 8:return w(!0),t.abrupt("return",!0);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(i.useEffect)((function(){W(O,e).then((function(e){o(e)})).catch((function(e){return alert("error fetching observer log",e)}))}),[]),Object(i.useEffect)((function(){r&&M(O,r.scenarioID,"V2").then((function(e){console.log("retrieve scenario:",e),f(e)}))}),[r]),Object(i.useEffect)((function(){b&&function(){N.apply(this,arguments)}()}),[b]),Object(i.useEffect)((function(){g&&H(O,e).then((function(e){l(e)})).catch((function(e){return alert("error fetching debriefing log",e)}))}),[g]),Object(i.useEffect)((function(){c&&x(!0)}),[c]),S?Object(V.jsx)(bt,{log:c,actions:c.events,scenario:b,context:"initial-analysis"}):Object(V.jsx)("h3",{children:"Loading"})},mt=function(){var e=Object(d.m)().logID,t=Object(i.useState)(null),n=Object(u.a)(t,2),r=n[0],o=n[1],s=Object(i.useState)(null),a=Object(u.a)(s,2),c=a[0],l=a[1],p=Object(i.useState)(!1),h=Object(u.a)(p,2),b=h[0],f=h[1];return Object(i.useEffect)((function(){W(O,e).then((function(e){o(e)}))}),[e]),Object(i.useEffect)((function(){r&&M(O,r.scenarioID).then((function(e){l(e),console.log("scenario",e)}))}),[r]),Object(i.useEffect)((function(){c&&f(!0)}),[c]),b?Object(V.jsx)(ft,{log:e}):Object(V.jsx)("h3",{children:"Loading"})};var vt=function(){var e=Object(d.m)().logID,t=Object(i.useState)(void 0),n=Object(u.a)(t,2),r=n[0],o=n[1],s=Object(i.useState)(void 0),a=Object(u.a)(s,2),c=a[0],l=a[1],p=Object(i.useState)(void 0),h=Object(u.a)(p,2),b=h[0],f=h[1],m=Object(i.useState)(!1),v=Object(u.a)(m,2),g=v[0],w=v[1],P=Object(i.useState)(!1),D=Object(u.a)(P,2),S=D[0],x=D[1];function E(){return(E=Object(y.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_(O,"debriefing-feedback-logs",e);case 2:if(t.sent){t.next=4;break}at(b,r);case 4:return w(!0),t.abrupt("return",!0);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(i.useEffect)((function(){W(O,e).then((function(e){o(e)})).catch((function(e){return alert("error fetching observer log",e)}))}),[e]),Object(i.useEffect)((function(){r&&M(O,r.scenarioID,"V2").then((function(e){console.log("scenario:",e),f(e)}))}),[r]),Object(i.useEffect)((function(){b&&function(){E.apply(this,arguments)}()}),[b]),Object(i.useEffect)((function(){g&&H(O,e).then((function(e){l(e)})).catch((function(e){return alert("error fetching debriefing log",e)}))}),[g]),Object(i.useEffect)((function(){c&&x(!0)}),[c]),S?Object(V.jsx)(bt,{log:c,actions:c.events,scenario:b,context:"review"}):Object(V.jsx)("h3",{children:"Loading"})},Ot=function(e){return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ht,{title:"MedDBriefer Authentication"}),e.children]})},gt=function(e){return Object(V.jsx)(l.AuthProvider,{children:Object(V.jsx)(c.HashRouter,{children:Object(V.jsxs)(d.g,{children:[Object(V.jsx)(l.PrivateRoute,{exact:!0,path:"/logs/:logID",authFlowLayout:Ot,component:mt}),Object(V.jsx)(l.PrivateRoute,{exact:!0,path:"/debriefing-feedback-logs/:logID",authFlowLayout:Ot,component:vt}),Object(V.jsx)(l.PrivateRoute,{exact:!0,match:"/",authFlowLayout:Ot,component:z})]})})})},jt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,68)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),r(e),i(e),o(e),s(e)}))};a.a.render(Object(V.jsx)(o.a.StrictMode,{children:Object(V.jsx)(gt,{})}),document.getElementById("root")),jt()}},[[61,1,2]]]);
//# sourceMappingURL=main.d3fd4384.chunk.js.map